{% extends "base.html" %}

{% block title %}{{ current_user.name }}{% endblock %}

{% block content %}
<div style="margin-left: 15%; margin-right: 15%">
    <br>
    <br>
    <h1>Profil</h1>
    <br>
    <table class="table">
        <tr>
            <th>Name:</th>
            <td>{{  current_user.name  }}</td>
        </tr>
        <tr>
            <th>Email:</th>
            <td>{{  current_user.email  }}</td>
        </tr>
        <tr>
            <th>Rollen:</th>
            <td>{{  current_user.role  }}</td>
        </tr>
        <tr>
            <th>Email Benachrichtigungen:</th>
            <td>{{  current_user.notifications  }}</td>
        </tr>
        <tr>
            <th>Verifizieren:</th>
            <td>
                <b><a style="text-decoration: none;" href="{{ verification_link }}">{{ verification_link }}</a></b>
            </td>
        </tr>
        <tr>
            <th>Passwort:</th>
            <td>
                {% if reset %}
                    <b><a style="text-decoration: none" href="{{ url_for('auth.reset_password', reset_id=reset) }}">Passwort zur√ºcksetzen</a></b><!-- (TODO send this per email)-->
                {% else %}
                    <form action="{{ url_for('auth.create_reset_token', user_id=current_user.id) }}">
                        <button type="submit">Request password reset</button>
                    </form>
                {% endif %}
            </td>
        </tr>
    </table>
    <h6><i class="bi bi-info-circle"></i>  Verification link is designed to work with manually entering it into browser -> clicking on this will lead to 404 error, in url remove the first 
        127.0.0.1/
    </h6>
    <br>
    <br>

    <!--------------------------------------------------------------------------------------------------------------------------------->
    <h3>Statistiken</h3>
    <br>
    <table class="table">
        <tr>
            <th>Upvoted Artikel:</th>
            <td>{{ upvoted|length }}</td>
        </tr>
        <tr>
            
        </tr>
        <tr>
            <th>Hochgeladene Artikel:</th>
            <td>{{ uploaded|length }}</td>
        </tr>
    </table>


    <table>
        <tr>
            <td>
                <div class="dropdown">
                    <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                      Hochgeladene Artikel
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                        {% for article in uploaded %}
                            <li><a class="dropdown-item" href="{{ url_for('articles.find_article', path='{0}.html'.format(article.id)) }}">{{ article.title }}</a></li>
                        {% endfor %}
                    </ul>
                </div>
            </td>
            <td>
                <div class="dropdown">
                    <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                      Upvoted Artikel
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                        {% for article in upvoted %}
                            <li>
                                <a class="dropdown-item" href="{{ url_for('articles.find_article', path='{0}.html'.format(article.id)) }}">
                                    {{ article.title }}
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            </td>
        </tr>
    </table>
</div>
{% endblock %}

{% block profil %}
    <li><a class="dropdown-item fw-bold" href="{{ url_for('views.profile') }}">Profil</a></li>
{% endblock %}
